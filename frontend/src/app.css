/* Import Google Fonts */
@import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500&family=Inter:wght@400;500;600;700&display=swap');

/* Tailwind CSS v4 */
@import "tailwindcss";

/* Explicit source path for Docker builds (no .git/.gitignore in container) */
@source ".";

/* Import component and page styles (after tailwindcss, before other directives) */
@import './styles/components.css';
@import './styles/pages.css';

/* Forms plugin */
@plugin "@tailwindcss/forms" {
  strategy: class;
}

/* Dark mode variant (class-based) */
@variant dark (&:where(.dark, .dark *));

/* Theme configuration */
@theme {
  /* Primary - Blue */
  --color-primary-light: #60a5fa;
  --color-primary: #3b82f6;
  --color-primary-dark: #2563eb;

  /* Secondary - Teal */
  --color-secondary-light: #5eead4;
  --color-secondary: #14b8a6;
  --color-secondary-dark: #0f766e;

  /* Semantic Colors - Light */
  --color-bg-default: #f8fafc;
  --color-bg-alt: #ffffff;
  --color-bg-sidebar: #f1f5f9;
  --color-fg-default: #1e293b;
  --color-fg-muted: #64748b;
  --color-fg-subtle: #94a3b8;
  --color-border-default: #e2e8f0;
  --color-border-input: #cbd5e1;
  --color-focus-ring: #93c5fd;

  /* Semantic Colors - Dark */
  --color-dark-bg-default: #0f172a;
  --color-dark-bg-alt: #1e293b;
  --color-dark-bg-sidebar: #020617;
  --color-dark-fg-default: #e2e8f0;
  --color-dark-fg-muted: #94a3b8;
  --color-dark-fg-subtle: #64748b;
  --color-dark-border-default: #334155;
  --color-dark-border-input: #475569;
  --color-dark-focus-ring: #3b82f6;

  --color-code-bg: #0f172a;

  /* Surface tokens for layered UI */
  --color-surface-overlay: #ffffff;
  --color-dark-surface-overlay: #1f2937;

  /* Interactive states */
  --color-interactive-hover: #f9fafb;
  --color-dark-interactive-hover: #374151;

  /* Skeleton/loading states */
  --color-skeleton: #e5e7eb;
  --color-dark-skeleton: #374151;

  /* Tooltip */
  --color-tooltip-bg: #111827;
  --color-tooltip-fg: #ffffff;

  /* Font Families */
  --font-sans: 'Inter', ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif;
  --font-mono: 'Fira Code', ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace;

  /* Custom Shadow */
  --shadow-input-focus: 0 0 0 3px var(--tw-shadow-color);

  /* Custom Timing Function */
  --ease-out-expo: cubic-bezier(0.16, 1, 0.3, 1);

  /* Animations */
  --animate-fadeIn: fadeIn 0.3s ease-out;
  --animate-flyIn: flyIn 0.3s var(--ease-out-expo);
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes flyIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

/* Custom utilities */
@utility animate-fadeIn {
  animation: var(--animate-fadeIn);
}

@utility animate-flyIn {
  animation: var(--animate-flyIn);
}

@layer base {
  body {
    @apply font-sans antialiased text-fg-default bg-bg-default dark:text-dark-fg-default dark:bg-dark-bg-default transition-colors duration-200;
    scroll-behavior: smooth;
  }

  /* Apply base form styles using the forms plugin classes */
  [type='text'],
  [type='email'],
  [type='password'],
  [type='number'],
  [type='search'],
  textarea,
  select {
    @apply form-input border-border-input dark:border-dark-border-input bg-bg-alt dark:bg-dark-bg-alt dark:text-dark-fg-default focus:border-primary dark:focus:border-primary focus:ring-3 focus:ring-focus-ring/50 dark:focus:ring-dark-focus-ring/50 rounded-md shadow-xs text-sm;
  }
   [type='text']:disabled,
   [type='email']:disabled,
   [type='password']:disabled,
   [type='number']:disabled,
   [type='search']:disabled,
   textarea:disabled,
   select:disabled {
     @apply bg-neutral-100 dark:bg-neutral-700 opacity-70 cursor-not-allowed;
   }
   select {
     @apply form-select pr-10; /* Ensure space for dropdown arrow */
   }
   [type='checkbox'], [type='radio'] {
     @apply form-checkbox rounded text-primary focus:ring-primary focus:ring-offset-0 focus:ring-2;
   }

   /* Default link styles */
   a {
     @apply text-primary hover:text-primary-dark dark:hover:text-primary-light transition-colors duration-150;
   }

   /* Custom Scrollbars */
   ::-webkit-scrollbar {
     width: 8px;
     height: 8px;
   }
   ::-webkit-scrollbar-track {
     @apply bg-neutral-200 dark:bg-neutral-700 rounded;
   }
   ::-webkit-scrollbar-thumb {
     @apply bg-neutral-400 dark:bg-neutral-500 rounded;
   }
   ::-webkit-scrollbar-thumb:hover {
     @apply bg-neutral-500 dark:bg-neutral-400;
   }

   /* CodeMirror Base Overrides */
    .cm-editor {
      @apply font-mono! text-sm border border-border-default dark:border-dark-border-default rounded-lg;
      height: 100% !important; /* Force height */
    }
    .cm-scroller {
      @apply font-mono!;
    }
    /* oneDark Theme specific overrides for better integration */
    .cm-theme-onedark .cm-gutters {
      @apply bg-bg-alt dark:bg-dark-bg-alt border-r border-border-default dark:border-dark-border-default text-fg-muted dark:text-dark-fg-muted;
    }
    .cm-theme-onedark .cm-activeLineGutter {
       @apply bg-neutral-200 dark:bg-neutral-700;
    }
    .cm-theme-onedark {
       @apply bg-bg-alt dark:bg-code-bg; /* Use code-bg for dark theme editor */
    }
    .cm-theme-onedark .cm-content {
       @apply text-fg-default dark:text-dark-fg-default; /* Adjust base text color */
    }
    .cm-theme-onedark .cm-cursor {
       @apply border-primary dark:border-primary-light; /* Make cursor more visible */
    }
    /* Selection background */
     .cm-theme-onedark .cm-selectionBackground,
     .cm-theme-onedark.cm-focused .cm-selectionBackground {
        @apply bg-primary/20 dark:bg-primary/30;
     }
}

@layer components {
  /* Reusable Button Styles */
  .btn {
    @apply inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-xs focus:outline-hidden focus:ring-2 focus:ring-offset-2 dark:focus:ring-offset-dark-bg-default transition-all duration-150 ease-in-out disabled:opacity-60 disabled:cursor-not-allowed;
  }
  .btn-sm {
    @apply px-3 py-1.5 text-xs rounded; /* Smaller padding/text/radius */
  }
  .btn-xs {
    @apply px-2.5 py-1 text-xs rounded;
  }
  .btn-icon {
    @apply p-2!; /* Specific padding for icon-only buttons */
  }
  .btn-primary {
    @apply text-white bg-primary hover:bg-primary-dark focus:ring-primary;
  }
  .btn-secondary {
     @apply text-white bg-secondary hover:bg-secondary-dark focus:ring-secondary;
  }
  .btn-secondary-outline {
     @apply text-neutral-700 bg-white border border-neutral-300 hover:bg-neutral-50 focus:ring-primary dark:text-dark-fg-default dark:bg-dark-bg-alt dark:border-dark-border-input dark:hover:bg-neutral-700;
  }
  .btn-ghost {
     @apply text-neutral-600 dark:text-neutral-400 hover:bg-neutral-100 dark:hover:bg-neutral-700 focus:ring-primary border-transparent bg-transparent shadow-none;
  }
  .btn-danger {
     @apply text-white bg-red-600 hover:bg-red-700 focus:ring-red-500;
  }
  .btn-danger-outline {
      @apply text-red-600 border border-red-300 hover:bg-red-50 focus:ring-red-500 dark:text-red-400 dark:border-red-500 dark:hover:bg-red-900/30;
  }

  /* Container Style */
  .app-container {
    @apply w-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8;
  }

  /* Card Style */
  .card {
    @apply bg-bg-alt dark:bg-dark-bg-alt rounded-lg shadow-md overflow-hidden border border-border-default dark:border-dark-border-default;
  }

  /* Input Group Style */
  .input-group {
     @apply flex items-center;
  }
  .input-group > :not(:last-child) {
     @apply rounded-r-none border-r-0;
  }
  .input-group > :not(:first-child) {
     @apply rounded-l-none;
  }

  /* Stacked Input Group (for login/register forms) */
  .input-group-stacked {
    @apply rounded-md shadow-xs -space-y-px;
  }

  .input-group-stacked > div:first-child input {
    @apply rounded-t-md rounded-b-none;
  }

  .input-group-stacked > div:last-child input {
    @apply rounded-b-md rounded-t-none;
  }

  .input-group-stacked > div:not(:first-child):not(:last-child) input {
    @apply rounded-none;
  }

  .input-group-stacked input {
    @apply appearance-none relative block w-full px-3 py-2 border
           border-neutral-300 dark:border-dark-border-input
           placeholder-fg-subtle dark:placeholder-dark-fg-subtle
           text-fg-default dark:text-dark-fg-default
           focus:outline-hidden focus:ring-primary focus:border-primary focus:z-10 sm:text-sm;
  }

  /* Form Control Styles */
  .form-control {
    @apply space-y-1;
  }

  .form-control label {
    @apply block text-sm font-medium text-fg-default dark:text-dark-fg-default;
  }

  /* Multi-select styles */
  .form-select-standard[multiple] {
    @apply overflow-y-auto;
  }

  .form-select-standard[multiple] option {
    @apply px-2 py-1 hover:bg-neutral-100 dark:hover:bg-neutral-700;
  }

  .form-select-standard[multiple] option:checked {
    @apply bg-primary/20 dark:bg-primary/30 font-medium;
  }

  /* Standard Input Styles */
  .form-input-standard {
    @apply w-full px-3 py-1.5 text-sm border border-neutral-300 dark:border-dark-border-input
           bg-white dark:bg-dark-bg-alt text-fg-default dark:text-dark-fg-default
           rounded-md focus:outline-hidden focus:ring-2 focus:ring-primary focus:border-primary
           hover:bg-neutral-50 dark:hover:bg-neutral-700 transition-colors;
  }

  .form-input-standard:disabled {
    @apply bg-neutral-100 dark:bg-neutral-700 opacity-70 cursor-not-allowed hover:bg-neutral-100 dark:hover:bg-neutral-700;
  }

  /* Number Input with Spinner Controls */
  .form-input-number {
    @apply w-full px-3 py-1.5 text-sm border border-neutral-300 dark:border-dark-border-input
           bg-white dark:bg-dark-bg-alt text-fg-default dark:text-dark-fg-default
           rounded-md focus:outline-hidden focus:ring-2 focus:ring-primary focus:border-primary
           hover:bg-neutral-50 dark:hover:bg-neutral-700 transition-colors;
  }

  /* Textarea Styles */
  .form-textarea {
    @apply w-full px-3 py-1.5 text-sm border border-neutral-300 dark:border-dark-border-input
           bg-white dark:bg-dark-bg-alt text-fg-default dark:text-dark-fg-default
           rounded-md focus:outline-hidden focus:ring-2 focus:ring-primary focus:border-primary
           hover:bg-neutral-50 dark:hover:bg-neutral-700 transition-colors resize-y min-h-[80px];
  }

  /* Select/Dropdown Styles */
  .form-select-standard {
    @apply w-full px-3 py-1.5 text-sm border border-neutral-300 dark:border-dark-border-input
           bg-white dark:bg-dark-bg-alt text-fg-default dark:text-dark-fg-default
           rounded-md focus:outline-hidden focus:ring-2 focus:ring-primary focus:border-primary
           hover:bg-neutral-50 dark:hover:bg-neutral-700 transition-colors pr-10 cursor-pointer;
  }

  /* Custom Dropdown Button */
  .form-dropdown-button {
    @apply w-full flex items-center justify-between text-left
           px-3 py-1.5 text-sm border border-neutral-300 dark:border-dark-border-input
           bg-white dark:bg-dark-bg-alt text-fg-default dark:text-dark-fg-default
           rounded-md focus:outline-hidden focus:ring-2 focus:ring-primary focus:border-primary
           hover:bg-neutral-50 dark:hover:bg-neutral-700 transition-colors cursor-pointer;
  }

  .form-dropdown-button svg {
    @apply w-5 h-5 ml-2 shrink-0 text-fg-muted dark:text-dark-fg-muted transform transition-transform;
  }

  .form-dropdown-button[aria-expanded="true"] svg {
    @apply -rotate-180;
  }

  /* Dropdown Menu */
  .form-dropdown-menu {
    @apply absolute top-full mt-1 w-full bg-bg-alt dark:bg-dark-bg-alt
           rounded-lg shadow-xl ring-1 ring-black/5
           dark:ring-white/10 z-30;
  }

  .form-dropdown-menu ul {
    @apply py-1;
  }

  .form-dropdown-menu li button {
    @apply w-full text-left px-3 py-2 text-sm hover:bg-neutral-100
           dark:hover:bg-neutral-700/60 transition-colors duration-100
           text-fg-default dark:text-dark-fg-default;
  }

  .form-dropdown-menu li button.selected {
    @apply text-primary dark:text-primary-light font-semibold;
  }

  /* Checkbox and Radio Styles */
  .form-checkbox-standard,
  .form-radio-standard {
    @apply form-checkbox rounded text-primary focus:ring-primary focus:ring-2;
  }

  .form-radio-standard {
    @apply rounded-full;
  }

  /* Toggle/Switch Style */
  .form-toggle {
    @apply relative inline-flex h-6 w-11 items-center rounded-full transition-colors
           focus:outline-hidden focus:ring-2 focus:ring-primary focus:ring-offset-2
           dark:focus:ring-offset-dark-bg-default cursor-pointer;
  }

  .form-toggle.checked {
    @apply bg-primary;
  }

  .form-toggle:not(.checked) {
    @apply bg-neutral-200 dark:bg-neutral-600;
  }

  .form-toggle-handle {
    @apply inline-block h-5 w-5 transform rounded-full bg-white transition-transform shadow-xs;
  }

  .form-toggle.checked .form-toggle-handle {
    @apply translate-x-5;
  }

  .form-toggle:not(.checked) .form-toggle-handle {
    @apply translate-x-0;
  }

  /* Date Input Styles */
  .form-input-date {
    @apply w-full px-3 py-1.5 text-sm border border-neutral-300 dark:border-dark-border-input
           bg-white dark:bg-dark-bg-alt text-fg-default dark:text-dark-fg-default
           rounded-md focus:outline-hidden focus:ring-2 focus:ring-primary focus:border-primary
           hover:bg-neutral-50 dark:hover:bg-neutral-700 transition-colors;
  }

  /* Error State Styles */
  .form-input-error {
    @apply border-red-500 dark:border-red-400 focus:ring-red-500 focus:border-red-500;
  }

  .form-error-message {
    @apply text-sm text-red-600 dark:text-red-400 mt-1;
  }

  /* Helper Text */
  .form-helper-text {
    @apply text-sm text-fg-muted dark:text-dark-fg-muted mt-1;
  }

  /* Label with Required Indicator */
  .form-label-required::after {
    content: " *";
    @apply text-red-500;
  }

  /* ==========================================================================
     Editor Component Styles
     ========================================================================== */

  /* Output container for code execution results */
  .output-container {
    @apply bg-bg-alt dark:bg-dark-bg-alt border border-border-default
           dark:border-dark-border-default rounded-lg p-4 w-full
           overflow-hidden shadow-xs;
  }

  /* Preformatted output text */
  .output-pre {
    @apply bg-bg-default dark:bg-dark-bg-default p-3 rounded border
           border-border-default dark:border-dark-border-default text-xs
           font-mono whitespace-pre-wrap break-words max-h-[40vh] overflow-auto;
    padding-right: 3rem; /* Space for copy button */
  }

  /* Output scrollbar styling */
  .output-content,
  .output-pre,
  .custom-scrollbar {
    scrollbar-width: thin;
    scrollbar-color: var(--color-fg-subtle) var(--color-skeleton);
  }

  :is(.dark .output-content),
  :is(.dark .output-pre),
  :is(.dark .custom-scrollbar) {
    scrollbar-color: var(--color-dark-fg-subtle) var(--color-dark-skeleton);
  }

  .output-content::-webkit-scrollbar,
  .output-pre::-webkit-scrollbar,
  .custom-scrollbar::-webkit-scrollbar {
    width: 6px;
    height: 6px;
  }

  .output-content::-webkit-scrollbar-track,
  .output-pre::-webkit-scrollbar-track,
  .custom-scrollbar::-webkit-scrollbar-track {
    @apply bg-neutral-100 dark:bg-neutral-800 rounded;
    margin-right: 2px;
  }

  .output-content::-webkit-scrollbar-thumb,
  .output-pre::-webkit-scrollbar-thumb,
  .custom-scrollbar::-webkit-scrollbar-thumb {
    @apply bg-neutral-300 dark:bg-neutral-600 rounded;
  }

  .output-content::-webkit-scrollbar-thumb:hover,
  .output-pre::-webkit-scrollbar-thumb:hover,
  .custom-scrollbar::-webkit-scrollbar-thumb:hover {
    @apply bg-neutral-400 dark:bg-neutral-500;
  }

  /* Output section positioning */
  .output-section .relative {
    overflow: visible;
  }

  .output-section .group,
  .relative .group {
    z-index: 10;
  }

  /* ==========================================================================
     Prose/Typography Styles (Privacy, Terms, etc.)
     ========================================================================== */

  .prose-page h2 {
    @apply mt-8 mb-4;
  }

  .prose-page p {
    @apply mb-4;
  }

  .prose-page section {
    @apply mb-6;
  }

  /* ==========================================================================
     Admin Component Styles
     ========================================================================== */

  /* Small input variant for admin tables */
  .input-sm {
    @apply px-2 py-1 text-sm border border-border-input dark:border-dark-border-input
           rounded bg-surface-overlay dark:bg-dark-surface-overlay text-fg-default dark:text-dark-fg-default;
  }
}
