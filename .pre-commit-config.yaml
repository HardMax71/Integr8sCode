# Pre-commit hooks configuration
# Install: uv tool install pre-commit && pre-commit install
# Run manually: pre-commit run --all-files

repos:
  # Local hooks using uv run to match CI exactly
  - repo: local
    hooks:
      # Ruff - matches CI: cd backend && uv run ruff check . --config pyproject.toml
      - id: ruff-backend
        name: ruff check (backend)
        entry: bash -c 'cd backend && uv run ruff check . --config pyproject.toml'
        language: system
        files: ^backend/.*\.py$
        pass_filenames: false

      # MyPy - matches CI: cd backend && uv run mypy --config-file pyproject.toml --strict .
      - id: mypy-backend
        name: mypy --strict (backend)
        entry: bash -c 'cd backend && uv run mypy --config-file pyproject.toml --strict .'
        language: system
        files: ^backend/.*\.py$
        pass_filenames: false

      # Grimp - matches CI: cd backend && uv run python scripts/check_orphan_modules.py
      - id: grimp-backend
        name: grimp orphan modules (backend)
        entry: bash -c 'cd backend && uv run python scripts/check_orphan_modules.py'
        language: system
        files: ^backend/.*\.py$
        pass_filenames: false

      # ESLint - matches CI: cd frontend && npx eslint src
      - id: eslint-frontend
        name: eslint (frontend)
        entry: bash -c 'cd frontend && npx eslint src'
        language: system
        files: ^frontend/src/.*\.(ts|svelte)$
        pass_filenames: false

      # Stylelint - matches CI: cd frontend && npx stylelint "src/**/*.css"
      - id: stylelint-frontend
        name: stylelint (frontend)
        entry: bash -c 'cd frontend && npx stylelint "src/**/*.css"'
        language: system
        files: ^frontend/src/.*\.css$
        pass_filenames: false

      # Svelte Check - matches CI: cd frontend && npx svelte-check
      - id: svelte-check-frontend
        name: svelte-check (frontend)
        entry: bash -c 'cd frontend && npx svelte-check --tsconfig ./tsconfig.json'
        language: system
        files: ^frontend/src/.*\.(ts|svelte)$
        pass_filenames: false
