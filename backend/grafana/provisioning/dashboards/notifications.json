{
  "annotations": {
    "list": []
  },
  "description": "Notifications",
  "editable": true,
  "gnetId": null,
  "graphTooltip": 1,
  "id": null,
  "panels": [
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 0
      },
      "id": 100,
      "panels": [],
      "title": "Overview",
      "type": "row"
    },
    {
      "datasource": "Victoria Metrics",
      "fieldConfig": {
        "defaults": {
          "unit": "short"
        }
      },
      "gridPos": {
        "h": 6,
        "w": 12,
        "x": 0,
        "y": 1
      },
      "id": 1,
      "targets": [
        {
          "expr": "rate(notifications_sent_total[5m])",
          "legendFormat": "Sent",
          "refId": "A"
        },
        {
          "expr": "rate(notifications_failed_total[5m])",
          "legendFormat": "Failed",
          "refId": "B"
        },
        {
          "expr": "rate(notifications_read_total[5m])",
          "legendFormat": "Read",
          "refId": "C"
        }
      ],
      "title": "Notification Flow",
      "type": "timeseries"
    },
    {
      "datasource": "Victoria Metrics",
      "fieldConfig": {
        "defaults": {
          "unit": "short"
        }
      },
      "gridPos": {
        "h": 4,
        "w": 4,
        "x": 12,
        "y": 1
      },
      "id": 2,
      "targets": [
        {
          "expr": "notifications_pending",
          "refId": "A"
        }
      ],
      "title": "Pending",
      "type": "stat"
    },
    {
      "datasource": "Victoria Metrics",
      "fieldConfig": {
        "defaults": {
          "unit": "short"
        }
      },
      "gridPos": {
        "h": 4,
        "w": 4,
        "x": 16,
        "y": 1
      },
      "id": 3,
      "targets": [
        {
          "expr": "notifications_queued",
          "refId": "A"
        }
      ],
      "title": "Queued",
      "type": "stat"
    },
    {
      "datasource": "Victoria Metrics",
      "fieldConfig": {
        "defaults": {
          "unit": "short"
        }
      },
      "gridPos": {
        "h": 4,
        "w": 4,
        "x": 20,
        "y": 1
      },
      "id": 4,
      "targets": [
        {
          "expr": "notifications_unread_count",
          "refId": "A"
        }
      ],
      "title": "Unread",
      "type": "stat"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 7
      },
      "id": 101,
      "panels": [],
      "title": "Channels",
      "type": "row"
    },
    {
      "datasource": "Victoria Metrics",
      "fieldConfig": {
        "defaults": {
          "unit": "short"
        }
      },
      "gridPos": {
        "h": 6,
        "w": 12,
        "x": 0,
        "y": 8
      },
      "id": 5,
      "targets": [
        {
          "expr": "rate(notifications_by_channel_total[5m])",
          "legendFormat": "{{channel}}",
          "refId": "A"
        }
      ],
      "title": "By Channel",
      "type": "timeseries"
    },
    {
      "datasource": "Victoria Metrics",
      "fieldConfig": {
        "defaults": {
          "unit": "short"
        }
      },
      "gridPos": {
        "h": 6,
        "w": 12,
        "x": 12,
        "y": 8
      },
      "id": 6,
      "targets": [
        {
          "expr": "rate(notifications_by_severity_total[5m])",
          "legendFormat": "{{severity}}",
          "refId": "A"
        }
      ],
      "title": "By Severity",
      "type": "timeseries"
    },
    {
      "datasource": "Victoria Metrics",
      "fieldConfig": {
        "defaults": {
          "unit": "short"
        }
      },
      "gridPos": {
        "h": 6,
        "w": 12,
        "x": 0,
        "y": 14
      },
      "id": 7,
      "targets": [
        {
          "expr": "histogram_quantile(0.95, rate(notification_channel_delivery_time_seconds_bucket[5m]))",
          "legendFormat": "p95",
          "refId": "A"
        }
      ],
      "title": "Channel Delivery Time",
      "type": "timeseries"
    },
    {
      "datasource": "Victoria Metrics",
      "fieldConfig": {
        "defaults": {
          "unit": "short"
        }
      },
      "gridPos": {
        "h": 6,
        "w": 12,
        "x": 12,
        "y": 14
      },
      "id": 8,
      "targets": [
        {
          "expr": "rate(notification_channel_failures_total[5m])",
          "legendFormat": "{{channel}}",
          "refId": "A"
        }
      ],
      "title": "Channel Failures",
      "type": "timeseries"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 20
      },
      "id": 102,
      "panels": [],
      "title": "Delivery",
      "type": "row"
    },
    {
      "datasource": "Victoria Metrics",
      "fieldConfig": {
        "defaults": {
          "unit": "short"
        }
      },
      "gridPos": {
        "h": 6,
        "w": 12,
        "x": 0,
        "y": 21
      },
      "id": 9,
      "targets": [
        {
          "expr": "histogram_quantile(0.95, rate(notification_delivery_time_seconds_bucket[5m]))",
          "legendFormat": "p95",
          "refId": "A"
        }
      ],
      "title": "Overall Delivery Time",
      "type": "timeseries"
    },
    {
      "datasource": "Victoria Metrics",
      "fieldConfig": {
        "defaults": {
          "unit": "short"
        }
      },
      "gridPos": {
        "h": 6,
        "w": 12,
        "x": 12,
        "y": 21
      },
      "id": 10,
      "targets": [
        {
          "expr": "rate(notification_status_changes_total[5m])",
          "legendFormat": "Changes",
          "refId": "A"
        }
      ],
      "title": "Status Changes",
      "type": "timeseries"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 27
      },
      "id": 103,
      "panels": [],
      "title": "Throttling & Retries",
      "type": "row"
    },
    {
      "datasource": "Victoria Metrics",
      "fieldConfig": {
        "defaults": {
          "unit": "short"
        }
      },
      "gridPos": {
        "h": 6,
        "w": 12,
        "x": 0,
        "y": 28
      },
      "id": 11,
      "targets": [
        {
          "expr": "rate(notifications_throttled_total[5m])",
          "legendFormat": "Throttled",
          "refId": "A"
        },
        {
          "expr": "rate(notification_throttle_window_hits_total[5m])",
          "legendFormat": "Window Hits",
          "refId": "B"
        }
      ],
      "title": "Throttling",
      "type": "timeseries"
    },
    {
      "datasource": "Victoria Metrics",
      "fieldConfig": {
        "defaults": {
          "unit": "short"
        }
      },
      "gridPos": {
        "h": 6,
        "w": 12,
        "x": 12,
        "y": 28
      },
      "id": 12,
      "targets": [
        {
          "expr": "rate(notification_retries_total[5m])",
          "legendFormat": "Retries",
          "refId": "A"
        },
        {
          "expr": "histogram_quantile(0.50, rate(notification_retry_success_rate_percent_bucket[5m]))",
          "legendFormat": "Success Rate p50",
          "refId": "B"
        }
      ],
      "title": "Retries",
      "type": "timeseries"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 34
      },
      "id": 104,
      "panels": [],
      "title": "Webhooks & Slack",
      "type": "row"
    },
    {
      "datasource": "Victoria Metrics",
      "fieldConfig": {
        "defaults": {
          "unit": "short"
        }
      },
      "gridPos": {
        "h": 6,
        "w": 12,
        "x": 0,
        "y": 35
      },
      "id": 13,
      "targets": [
        {
          "expr": "histogram_quantile(0.95, rate(notification_webhook_delivery_time_seconds_bucket[5m]))",
          "legendFormat": "p95",
          "refId": "A"
        },
        {
          "expr": "rate(notification_webhook_response_status_total[5m])",
          "legendFormat": "{{status}}",
          "refId": "B"
        }
      ],
      "title": "Webhook Delivery",
      "type": "timeseries"
    },
    {
      "datasource": "Victoria Metrics",
      "fieldConfig": {
        "defaults": {
          "unit": "short"
        }
      },
      "gridPos": {
        "h": 6,
        "w": 12,
        "x": 12,
        "y": 35
      },
      "id": 14,
      "targets": [
        {
          "expr": "histogram_quantile(0.95, rate(notification_slack_delivery_time_seconds_bucket[5m]))",
          "legendFormat": "p95",
          "refId": "A"
        },
        {
          "expr": "rate(notification_slack_api_errors_total[5m])",
          "legendFormat": "Errors",
          "refId": "B"
        }
      ],
      "title": "Slack",
      "type": "timeseries"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 41
      },
      "id": 105,
      "panels": [],
      "title": "Subscriptions",
      "type": "row"
    },
    {
      "datasource": "Victoria Metrics",
      "fieldConfig": {
        "defaults": {
          "unit": "short"
        }
      },
      "gridPos": {
        "h": 6,
        "w": 12,
        "x": 0,
        "y": 42
      },
      "id": 15,
      "targets": [
        {
          "expr": "notification_subscriptions_active",
          "legendFormat": "Active",
          "refId": "A"
        },
        {
          "expr": "rate(notification_subscription_changes_total[5m])",
          "legendFormat": "Changes",
          "refId": "B"
        }
      ],
      "title": "Subscriptions",
      "type": "timeseries"
    }
  ],
  "refresh": "10s",
  "schemaVersion": 33,
  "style": "dark",
  "tags": [
    "notifications"
  ],
  "templating": {
    "list": []
  },
  "time": {
    "from": "now-3h",
    "to": "now"
  },
  "timepicker": {},
  "timezone": "",
  "title": "Notifications",
  "uid": "notifications",
  "version": 1
}
