{{- if .Values.infrastructure.kafka.enabled }}
{{- $superPassword := .Values.infrastructure.kafka.jaas.superPassword | default "admin-secret" }}
{{- $kafkaPassword := .Values.infrastructure.kafka.jaas.kafkaPassword | default "kafka-secret" }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "integr8scode.fullname" . }}-kafka-jaas
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "integr8scode.labels" . | nindent 4 }}
type: Opaque
stringData:
  kafka_jaas.conf: |
    Server {
        org.apache.zookeeper.server.auth.DigestLoginModule required
        user_super="{{ $superPassword }}"
        user_kafka="{{ $kafkaPassword }}";
    };

    Client {
        org.apache.zookeeper.server.auth.DigestLoginModule required
        username="kafka"
        password="{{ $kafkaPassword }}";
    };
{{- end }}
